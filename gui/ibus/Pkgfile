makedepends=(dconf iso-codes gobject-introspection gtk2 libnotify vala python python-gobject  libxkbcommon dbus-python python2-xdg)

description="IBus is an Intelligent Input Bus."
url="http://ibus.googlecode.com"

packager="Yaolinux Team"

name=ibus
version=1.5.21

source=(https://github.com/ibus/ibus/releases/download/$version/$name-$version.tar.gz)

build() {
cd $name-$version

  sed -i 's|$(libibus) $(libibus_emoji_dialog)|$(libibus_emoji_dialog) $(libibus)|' ui/gtk3/Makefile.am

./autogen.sh --prefix=/usr           \
             --sysconfdir=/etc       \
             --enable-wayland        \
             --enable-ui             \
             --enable-python-library \
             --with-python=python3   

rm -r "$PKG"/usr/lib/python2.7/site-packages/gi # compiled pyc/pyo files were not cleaned

make
make DESTDIR=$PKG install
}