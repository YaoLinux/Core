makedepends=(qtbase speech-dispatcher)

description="A cross-platform application and UI framework, QtSpeech files"
url="http://qt-project.org/"

maintainer="rems"
packager="Yaolinux Team"

name=qtspeech
version=5.13.1

_name="${name}-everywhere-src"

source=(https://download.qt.io/official_releases/qt/${version:0:4}/$version/submodules/${_name}-${version}.tar.xz
        https://src.fedoraproject.org/rpms/qt5-qtspeech/raw/master/f/qtspeech-speech-dispatcher_includes.patch)

prepare() {

cd ${_name}-${version}

patch -Np1 -i ../qtspeech-speech-dispatcher_includes.patch

mkdir -v ../build
}

build() {

cd build

qmake ../${_name}-${version}

LIBSPEECHD_MAJOR_VERSION=1 \
make
make INSTALL_ROOT=$PKG install

# Drop QMAKE_PRL_BUILD_DIR because reference the build dir
  find "$PKG/usr/lib" -type f -name '*.prl' \
       -exec sed -i -e '/^QMAKE_PRL_BUILD_DIR/d' {} \;
}
