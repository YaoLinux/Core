makedepends=(autoconf2-13 icu libffi nspr python2 zip)

packager="Yaolinux Team"
maintainer="sipo"

description="JS is Mozilla's JavaScript engine written in C."
url="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/SpiderMonkey"

name=js60
version=60.9.0

source=(http://ftp.acc.umu.se/pub/gnome/teams/releng/tarballs-needing-help/mozjs/mozjs-$version.tar.bz2)

prepare(){

    cd mozjs-$version

    mkdir mozjs-build
    cd    mozjs-build
}

build() {

   cd mozjs-$version/mozjs-build
   ../js/src/configure --prefix=/usr       \
                       --with-intl-api     \
                       --with-system-zlib  \
                       --with-system-nspr  \
                       --with-system-icu   \
                       --disable-jemalloc  \
                       --enable-readline

  make

}


package() {

   cd mozjs-$version/mozjs-build
   make DESTDIR=$PKG install

  # Already present on js38
  rm $PKG/usr/lib/libjs_static.ajs

}
